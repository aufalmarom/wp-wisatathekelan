!function(a){"use strict";var t;a.fn.tatsuParallax=function(e){t=a(this),e=a.extend({speed:.4},e);var n=window.innerHeight,r=function(){var r,s,i,o,d=a(window).scrollTop();t.each(function(){if((r=a(this)).hasClass("tatsu-parallaxed")){if(o=r.data("speed")||e.speed,s=r.offset().top,i=r.outerHeight(!0),s+i<d||s>d+n)return;var t=s-n>0?s-n:0;r.find(".tatsu-parallax-element-wrap").css({transform:"translate3d( 0,"+Math.round((d-t)*-o)+"px, 0)"})}})},s=function(e,r){if(e)var s=a(".tatsu-parallaxed").find(".tatsu-parallax-element-wrap");else s=t.find(".tatsu-parallax-element-wrap");s.each(function(){var t,e,s=a(this),i=s.parent(),o=i.outerHeight(),d=s.parent().offset().top,l=document.body.scrollHeight;if(i.data("speed")&&!r?e=i.data("speed"):(e=r,i.data({speed:r})),l>d+o+n)t=Math.round((o+n)*e)+o,d<n&&(t=o+Math.round((o+d)*e));else{t=s.parent().innerHeight()+Math.round((l-d)*e)}s.height(t)})};return a(window).on("resize",function(){n=window.innerHeight,s(!0),r()}),a(window).on("scroll",function(){requestAnimationFrame(function(){r()})}),t.each(function(){a(this).hasClass("tatsu-parallaxed")||a(this).addClass("tatsu-parallaxed")}),s(!1,e.speed),this}}(jQuery);