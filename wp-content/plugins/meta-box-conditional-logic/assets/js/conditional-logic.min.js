!function($){"use strict";function checkCompareStatement(e,t,n){switch((null===e||"undefined"==typeof e)&&(e=""),n){case"=":return $.isArray(e)&&$.isArray(t)?0===$(e).not(t).length&&0===$(t).not(e).length:e==t;case">=":return e>=t;case">":return e>t;case"<=":return t>=e;case"<":return t>e;case"contains":if($.isArray(e))return $.inArray(t,e)>-1;if("string"==$.type(e))return e.indexOf(t)>-1;case"in":if($.isArray(e)){var i=!1;return $.each(e,function(e,n){$.isNumeric(n)&&(n=parseInt(n)),t.indexOf(n)>-1&&(i=!0)}),i}return t.indexOf(e)>-1;case"start_with":return 0===e.indexOf(t);case"starts with":return 0===e.indexOf(t);case"end_with":return t=new RegExp(t+"$"),t.test(e);case"ends with":return t=new RegExp(t+"$"),t.test(e);case"match":return t=new RegExp(t),t.test(e);case"between":if($.isArray(t)&&"undefined"!=typeof t[0]&&"undefined"!=typeof t[1])return checkCompareStatement(e,t[0],">=")&&checkCompareStatement(e,t[1],"<=")}}function getFieldValue(fieldName,$scope){if(checkCompareStatement(fieldName,"(","contains"))return eval(fieldName);if($("#"+fieldName).length&&"checkbox"!==$("#"+fieldName).attr("type")&&"undefined"!=typeof $("#"+fieldName).val()&&null!=$("#"+fieldName).val()&&""==$scope&&(fieldName="#"+fieldName),checkCompareStatement(fieldName,"#","start_with")&&"checkbox"!==$(fieldName).attr("type")&&"undefined"!=typeof $(fieldName).val()&&null!=$(fieldName).val()&&""==$scope)return $(fieldName).val();var selector=null;if($('[name="'+fieldName+'"]').length&&(selector='[name="'+fieldName+'"]'),$('[name*="'+fieldName+'"]').length&&(selector='[name*="'+fieldName+'"]'),null!==selector){var selectorType=$(selector).attr("type");if($.inArray(selectorType,["text","file"])>-1)return""==$scope?$(selector).val():$scope.find(selector).val();if($.inArray(selectorType,["checkbox","radio","hidden"])>-1){var arr=[],elements=[];return elements="hidden"!==selectorType||"post_category"===fieldName||checkCompareStatement(selector,"tax_input","contains")?""!=$scope?$scope.find(selector+":checked"):$(selector+":checked"):""!=$scope?$scope.find(selector):$(selector),elements.length>1&&"radio"!=selectorType?elements.each(function(){arr.push($(this).val())}):arr=1===elements.length?elements.val():0,arr}return""==$scope?$(selector).val():$scope.find(selector).val()}return 0}function isLogicCorrect(e,t){var n="undefined"!=typeof e.relation?e.relation:"and",i="and"==n;return $.each(e.when,function(e,r){var a=$(guessSelector(r[0])).closest(".rwmb-field").attr("data-visible");if("hidden"==a)i="hidden";else{if(""!=t){var c=guessSelector(r[0]);t.find(c).length||(t="")}var o=getFieldValue(r[0],t),s=r[1],l=r[2],d=!1,f=!1;$.isArray(o)&&1===o.length&&(o=o[0]),(checkCompareStatement(s,"not","contains")||checkCompareStatement(s,"!","contains"))&&(f=!0,s=s.replace("not",""),s=s.replace("!","")),s=s.trim(),$.isNumeric(o)&&(o=parseInt(o)),d=checkCompareStatement(o,l,s),f&&(d=!d),i="and"===n?i&&d:i||d}}),i}function runConditionalLogic(e){window.eventSource=[],$(".rwmb-conditions").each(function(){var e=$(this),t=e.data("conditions"),n="undefined"!=typeof t.hidden?"hidden":"visible",i=t[n],r="";e.parents().hasClass("rwmb-clone")&&(r=e.parents(".rwmb-clone"));var a=isLogicCorrect(i,r),c=e.parent().hasClass("rwmb-field")?e.parent():e.parents(".postbox");a===!0?"visible"==n?applyVisible(c):applyHidden(c):a===!1?"visible"==n?applyHidden(c):applyVisible(c):"hidden"===a&&applyHidden(c),$.each(i.when,function(e,t){if(!checkCompareStatement(t[0],"(","contains")){var n=guessSelector(t[0]);$.inArray(n,window.eventSource)<0&&"undefined"!=typeof n&&window.eventSource.push(n)}})}),$.each(e,function(e,t){$.each(t,function(t,n){if("undefined"!=typeof n.when){var i=guessSelector(e),r=isLogicCorrect(n,"");r===!0?"visible"==t?applyVisible($(i)):applyHidden($(i)):r===!1?"visible"==t?applyHidden($(i)):applyVisible($(i)):"hidden"===r&&applyHidden($(i)),$.each(n.when,function(e,t){if(!checkCompareStatement(t[0],"(","contains")){var n=guessSelector(t[0]);$.inArray(n,window.eventSource)<0&&"undefined"!=typeof n&&window.eventSource.push(n)}})}})}),window.eventSource.push(".add-clone"),window.eventSource=window.eventSource.join()}function guessSelector(e){if(checkCompareStatement(e,"(","contains"))return null;if($(e).length||isUserDefinedSelector(e))return e;try{if($("#"+e).length&&"checkbox"!==$("#"+e).attr("type")&&!$("#"+e).attr("name"))return"#"+e;if($('[name="'+e+'"]').length)return'[name="'+e+'"]';if($('[name^="'+e+'"]').length)return'[name^="'+e+'"]';if($('[name*="'+e+'"]').length)return'[name*="'+e+'"]'}catch(t){console.log(t)}}function isUserDefinedSelector(e){return checkCompareStatement(e,".","starts with")||checkCompareStatement(e,"#","starts with")||checkCompareStatement(e,"[name","contains")||checkCompareStatement(e,">","contains")||checkCompareStatement(e,"*","contains")||checkCompareStatement(e,"~","contains")}function applyVisible(e){e.closest(".rwmb-field").length&&(e=e.closest(".rwmb-field")),e.hasClass("rwmb-column")?e.css("visibility","visible"):e.show(),e.attr("data-visible","visible")}function applyHidden(e){e.closest(".rwmb-field").length&&(e=e.closest(".rwmb-field")),e.hasClass("rwmb-column")?e.css("visibility","hidden"):e.hide(),e.attr("data-visible","hidden")}var conditions=window.conditions;runConditionalLogic(conditions),window.eventSource.length>1&&$(window.eventSource).live("change keyup click",function(){runConditionalLogic(conditions)})}(jQuery);